just some notes regarding the project...


Inferring model parameters (N=448, all regions)
Lilelihood computed from all data points

diffusion+aggregation+death
    works great when having dydt = gamma * (1 - y)
    including x, either as 
    death_u = gamma*(x-y) or 
    death_2u = gamma*x*(x-y)

    does not do that well...
    In those casees with x, the d's are just too small and we don't see as good declines as the non-x case.
    However..  death_u (death_2u not tested yet) did do well on N=40. You would think it would just increase 
    the d's where x is small. But it does not. 

    Maybe the different versions of death have success dependent on how much data is included?
    I tried skipping the first <1 month timepoints and it does help but is not as good as death = gamma * (1-y)

    Next up to try is dydt = gamma*x*(1-y)
    maybe this is better?
    -> skipping the first timepoints, it is not that bad. But still not as good as death. It still overestimates a lot of regions at the end
    -> trying out with all data to see if it makes a difference -> it is better, but at all as good as dydt = gamma (1-y)

    I also tried setting "all" parameters to being local, and it still doesn't get the last time points right with death_u.
    It is frustrating that it works death_u works for N=40, but that not for N=448. 

diffusion+aggregation
    works great (though a bit slow), of course the end points are overestimated by the model, but that is expected

diffusion
    if including all data points, the model does not want to remove anterograde transport.
    The result is that the steady-state is homogeneous. This makes sense from the model formulation.
    If rho_ratio = 1, then the effective Laplacian is symmetric.

    if only including time points (1.0, 3.0, 6.0, 9.0), the model prefers retrograde, however it sets the seed too low.
    The result is almost no pathology anywhere, though the order of pathology severity is preserved. 
    Might this be because, when including all data samples, most regions have many samples close to zero at all timepoints? inspecting the data, this looks plausible
    because when looking at predicted vs (mean) observed, it looks like increasing the seed would give a really good fit.
    Looks bizarre that the seed is estimated to be that low. And it is reproducible, I tried with different priors for the seed and 
    they give the same posterior.

    perhaps the only way to make the bayesian inference prefer a proper spreading is to fit to sample-averaged data points. 
    this did indeed work better, predicted vs obseerved looks way more reasonable

    However!! if we are to compare the model with other models, we should fit them to the same data points at least...
    maybe we have to change the priors, but the data should stay the same

    So I will try to fit the diffusion2 to all data points again but with rho_ratio prior centered at 0
    -> This gives the same posteriors as diffusion2 with mean data points
    Hmm..

    SOLVED:
    putting seed ~ Normal(1, 0.5) gives at least arguably sensible results with full data
    


GENE EXPRESSION CORRELATION

the regions of in the gene expression data does not correspond directly 
to the structural connectome regions. The gene data regions are coarser and bilateral.
Hence, we can average the simulated pathology subregions and correlate to gene expression regions.

As for the bilateral vs lateral-specific...
What makes more sense is averaging the simulated pathology across both hemispheres..
if not.. maybe do one analysis for the average and then for each hemisphere?


I tried fitting the average, and also for each hemisphere.. either way
the correlations are low. The highest R^2 is around 0.23 (for single gene).
SNCA is among the highest correlations though, which is nice. 
I tested both betas and death rates for aggregation and aggregation+death
the results are similar

